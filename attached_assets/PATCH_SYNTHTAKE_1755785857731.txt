// --- add to the top of rag.router.js ---
// import { loadLexicon, enrichText } from './rag_lexicon.js';
// loadLexicon(process.env.FF_LEXICON_PATH);  // call once on boot

// --- inside synthTake(player, topic, rows) ---
// After computing 'body' and before returning payload:
  const blob = `${latest.title || ""} ${latest.text || ""}`.toLowerCase();
  const enriched = enrichText(body, blob);
  const confAdj = Math.max(-5, Math.min(5, enriched.delta));  // clamp
  const finalConf = Math.max(0, Math.min(100, conf + confAdj));
  const takeText = enriched.text;

// And then return using takeText & finalConf instead of original:
  return {
    headline: `${name}: actionable update (${dt})`,
    take: takeText,
    verdict,
    confidence: finalConf,
    facts: { team, position: pos, topic, articles_considered: rows.length },
    citations: rows.map(r => ({ title: r.title, url: r.url, published_at: r.published_at, source: r.source }))
  };
