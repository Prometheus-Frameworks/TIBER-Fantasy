# WAIVER WISDOM MODULE SPEC v1.1  
**Live Target: 2025 Season**  
**2024 = test sandbox only**  
All user-facing waiver recommendations must be based on 2025 weekly data + Sleeper ownership once 2025 rows exist. Until then, the system will gracefully return â€œNo 2025 waiver data available yet â€” hereâ€™s what the engine will do when itâ€™s live.â€ No silent 2024 masquerading.

### 1. Data & Thresholds

| Source                | Key Fields (2025)                                 | Ownership Bands (Sleeper) |
|-----------------------|---------------------------------------------------|---------------------------|
| weekly_stats          | PPG, carries, targets, rec yds, rush yds, TDs, EPA, WOPR, target_share, air_yards_share, YPRR, red-zone touches | < 30% â†’ almost always free  <br>30-50% â†’ often free in casual leagues  <br>50-70% â†’ streamer / deep bench  <br>> 70% â†’ never generic waiver add |
| sleeper_ownership     | ownership_percentage (daily pull)                 |                           |

### 2. Waiver Wisdom Algorithm

1. Candidate Pool  
   - ownership_percentage < 50%  
   - AND (last week â‰¥ 8 half-PPR points OR usage spike â‰¥ 30% week-over-week)

2. Interest Score (0â€“100) â€” weighted  
   - Recent production (last 1-3 weeks) â€” 35%  
   - Opportunity delta (targets/carries/WOPR) â€” 30%  
   - Efficiency vs position baseline â€” 15%  
   - Ecosystem quality (team scoring rank, pace) â€” 10%  
   - Archetype bonus (handcuff, injury fill, etc.) â€” 10%

3. Tier Mapping  
   | Interest Score | Tier | Label             | FAAB Guide (12-team) |
   |----------------|------|-------------------|----------------------|
   | 85â€“100         | S    | Must-Add          | 25â€“50%+              |
   | 70â€“84          | A    | Strong Add        | 15â€“30%               |
   | 55â€“69          | B    | Speculative Stash | 5â€“15%                |
   | 40â€“54          | C    | Handcuff / Deep   | 1â€“10%                |
   | < 40           | D    | Trap / Avoid      | 0%                   |

### 3. Archetype Classifier (Hard Rules)

| Archetype            | Detection Logic                                                                 | Voice Line Example |
|----------------------|---------------------------------------------------------------------------------|---------------------|
| Breakout             | Age â‰¤ 25 + usage spike + EPA > position avg + role expansion                    | â€œThis isnâ€™t a one-week flash â€” the role is growing and the efficiency is legit.â€ |
| Handcuff             | Clear bell-cow ahead + offense top-12 scoring + low current touches            | â€œNot a starter now, but one injury away from 18-touch weeks in a great offense.â€ |
| Injury Replacement   | Direct replacement for IR/out starter + temporary role flagged                 | â€œSolid fill-in while the starter heals, but this job disappears when heâ€™s back.â€ |
| Role/Scheme Shift    | Same player, new OC/QB or depth-chart promotion                                 | â€œSame guy, brand-new opportunity â€” the scheme finally fits.â€ |
| Trap / Mirage        | High points + low routes/snaps + garbage-time flag                             | â€œOne big game on six touches in a blowout. Classic waiver trap â€” stay away.â€ |

### 4. Backend Implementation (Grok Task)

1. **sleeper_ownership** table + daily ingest script  
2. **waiver_candidates** table (schema below)  
3. **waiver_candidates_builder.ts** â€” cron daily @ 4 AM ET  
   - Pulls last 3 weeks + ownership  
   - Calculates interest_score + archetype + tier  
   - Writes/updates row  
4. Endpoints  
   - `GET /api/waivers/recommendations` (filters: pos?, tier?, week=CURRENT)  
   - `GET /api/waivers/player?player=Name` (single-player diagnosis)

```ts
// waiver_candidates schema
id: serial pk
season: int
week: int
player_id: text
position: text
ownership_percentage: decimal
interest_score: decimal
waiver_tier: 'S'|'A'|'B'|'C'|'D'
archetype: text
summary: text (1â€“2 sentence machine note)
created_at / updated_at
```

### 5. Chat / RAG Behavior (Claude Task)

**Detection Triggers** (exact phrases or strong intent)  
- â€œwaiver wireâ€ / â€œwaiver addsâ€ / â€œwho to pick upâ€ / â€œbest waiversâ€ / â€œstashâ€

**Response Rules**  
- Always call `/api/waivers/recommendations` first  
- Max 5 players returned  
- Always lead with ownership % (â€œlikely sitting on most waiver wires at X% rosteredâ€)  
- One-sentence archetype + one-sentence why  
- Never recommend >70% owned as generic waiver add

**Sample Output**  
â€œThree names actually on most waiver wires right now (<50% rostered):  
â€¢ Emmanuel Wilson (3%) â€“ Tier C handcuff behind Jacobs in a top-5 scoring offense. Pure lottery ticket that hits RB1 if Jacobs misses time.  
â€¢ Adonai Mitchell (28%) â€“ Tier A breakout. Routes and targets both spiked last two weeks; the role is sticking.  
â€¢ Cade Otton (41%) â€“ Tier B injury fill. Starting TE out â€” heâ€™s the direct replacement until further notice.â€

Ready for code drop â€” let me know when you want the full builder script + endpoint code. This thing is about to cook. âš¡ğŸˆ