v1 ‚Äî Methodology, Data, Backend (this sprint)
A) Scoring framework (format-aware)
Redraft (this season, week-to-week ready)

Composite per player, position-normalized to 0‚Äì100:

RedraftScore = 0.35 * Opportunity + 0.25 * Efficiency + 0.15 * RoleStability
             + 0.10 * TeamEnvironment + 0.10 * HealthRiskAdj + 0.05 * SOSAdj


Opportunity (heavy): snap% / routes_run / targets per route (WR/TE) / rush share & route share (RB) / team pass rate (QB/WR/TE).

Efficiency: YPRR (WR/TE), missed tackles forced / YAC (RB), EPA/play (QB), success rate, explosive rates.

RoleStability: depth chart lock, 2-minute/drill/goal-line share, coach usage history, contract guarantees.

TeamEnvironment: team EPA/play, pace, red-zone plays, implied totals (proxy by team scoring rate).

HealthRiskAdj: recent DNPs, in-game exits, injury status ‚Üí small penalty.

SOSAdj: our v2 contextual SOS weighted last 3 weeks upcoming (light nudge, not dominant).

Dynasty (multi-year value)

3-year discounted value + prospect/pedigree + age curve, position-aware:

DynastyScore = 0.40 * 3yrProj + 0.20 * AgeCurveAdj + 0.15 * RoleStability
             + 0.10 * Efficiency + 0.10 * TeamEnvironment + 0.05 * ProspectPedigree


3yrProj: roll forward using current opp/eff baselines with decay (year1 60%, year2 25%, year3 15%).

AgeCurveAdj: position curves (RB peak 23‚Äì26, WR 24‚Äì28, TE later, QB longest tail).

ProspectPedigree: draft capital + breakout age + first-year usage.

Same smaller weights for efficiency & environment; dynasty cares less about SOS blips.

Position weight overrides (strong take)

RB redraft: Opportunity 0.45, Efficiency 0.20, Role 0.15, Team 0.10, Health 0.05, SOS 0.05

WR redraft: Opportunity 0.30, Efficiency 0.30, Role 0.15, Team 0.15, Health 0.05, SOS 0.05

TE redraft: Opportunity 0.32, Efficiency 0.23, Role 0.20, Team 0.15, Health 0.05, SOS 0.05

QB redraft: Opportunity (dropbacks + rush share) 0.25, Efficiency (EPA/CPA/AY/A) 0.35, Role 0.15, Team 0.20, Health 0.03, SOS 0.02

Normalization & tiers

Percentile per position ‚Üí 0‚Äì100.

VOR: percentile vs positional replacement (RB40, WR48, TE16, QB12 by default).

Tiers auto-split at inflection points (hierarchical clustering on score deltas).

Debug output (API)

Return breakdown per player:

debug: { Opp: 78, Eff: 66, Role: 72, Team: 64, Health: -3, SOS: +2, VOR: 18 }

B) Data we need (pipelines)

Inputs per player-week (redraft), plus season aggregates (dynasty):

Usage: snap%, routes, targets, rush att share, GL/2-min share.

Efficiency: YPRR, RACR, mtf, YAC/att, rush success, EPA/play (QB).

Team env: team EPA/play, pace, red-zone plays, pass rate.

Role stability: depth chart rank, contract $ guarantees, coach usage trend (simple rolling).

Health: DNP flags, questionable tags ‚Üí small penalty.

SOS v2: our contextual weekly score (already built).

Dynasty extras: age, draft round/pick, breakout age proxy, contract years left.

C) DB schema (migrations)

1) player_inputs (weekly)

player_id, season, week, position, team
snap_pct, routes, tprr, rush_share, target_share, goalline_share, two_min_share
yprr, yac_per_rec, mtf, succ_rate, epa_per_play_qb
team_epa_play, team_pace, team_rz_plays
injury_status, dnp_weeks_rolling
PRIMARY (player_id, season, week)


2) player_profile (static/seasonal)

player_id, name, position, team, age, draft_round, draft_pick, contract_yrs_left, guarantees_usd
PRIMARY (player_id)


3) player_scores (computed)

player_id, season, week, format ('redraft'|'dynasty'), position,
score, vor, tier, weights_json, debug_json
PRIMARY (player_id, season, week, format)


4) age_curves (reference)

position, age, multiplier   -- e.g., RB: 21:0.95, 23:1.05, 27:0.98, 29:0.90 ...
PRIMARY (position, age)

D) Backend endpoints

GET /api/ratings
Params: format=redraft|dynasty, position, season, week (week optional for dynasty), limit, debug=1, weights=csv (override).
Returns: sorted list incl. score, tier, vor, and debug.

GET /api/players/:id/rating
Params: format, season, week ‚Üí single player breakdown + trend last 4.

GET /api/ratings/tiers
Params: format, position, season, week ‚Üí cluster-based tiers + cutlines.

Admin: /api/ratings/recompute (protected) to recompute with new weights.

E) Update cadence

Weekly compute job: runs Tuesday 6am ET after stat corrections.

Hot-fix compute: manual trigger.

v1 ‚Äî Delegation (paste these to agents)
üëâ DeepSeek ‚Äî Methodology & Weights Spec

‚ÄúDraft docs/ratings-method-v1.md with the formulas above. Include per-position default weights (redraft & dynasty), the percentile normalization rules, VOR definition (RB40/WR48/TE16/QB12 defaults), and the tiering algorithm (clustering on score deltas). Add a section for weights=? URL overrides and an examples table with 5 sample players (fake names OK).‚Äù

üëâ Grok ‚Äî Pipelines & Ingest

‚ÄúCreate scripts to populate player_inputs weekly (usage/eff/team/health) and player_profile (age, draft, contract). Wire SOS v2 weekly scores into player_inputs.sos_ctx. Output CSVs and COPY commands. Provide a small seed (3 random weeks 2024) for dev, then full 2024 W1-17. Deliver scripts/compute_player_scores.py that reads inputs + weights, writes player_scores (both formats).‚Äù

üëâ Claude ‚Äî Docs & QA

‚ÄúWrite QA/ratings_v1_checklist.md:

Regression: endpoint stability

Score sanity ranges per position

VOR math spot-checks vs replacement lines

Tier consistency (no single-player ‚Äòtiers‚Äô)

Weights override test (weights=0.5,0.25,0.15,0.1 etc.)

Dynasty 3-yr projection discounting validation

Debug numbers sum to composite (within rounding).
Add curl commands + sample JSON validation snippets.‚Äù

üëâ Tiber ‚Äî Backend

Migrations for the 4 tables above.

Implement endpoints (GET /api/ratings, /players/:id/rating, /ratings/tiers).

Score compute service: accept default weights by position/format, allow overrides via query, persist to player_scores.

debug=1 returns component breakdown + VOR + tier.

Batch queries; no N+1. Add indices: (season,week,position) where relevant.

v2 ‚Äî UI & Weekly Ops (next sprint)

/rankings page: tabs Redraft / Dynasty; position filter; search; tier separators; weight preset dropdown (Balanced / Prospect-heavy / Win-Now).

Player row: team logo, bye week, next opponent SOS chip, trend sparkline (last 4 redraft scores), and ‚Äúwhy‚Äù tooltip (debug).

Player page module: historical score chart + component sliders (future).

Weekly job wired to auto-refresh ratings Tuesday mornings.

Paste-ready ‚Äúweights default‚Äù (drop into code)
export const DEFAULT_WEIGHTS = {
  redraft: {
    RB: { opp: 0.45, eff: 0.20, role: 0.15, team: 0.10, health: 0.05, sos: 0.05 },
    WR: { opp: 0.30, eff: 0.30, role: 0.15, team: 0.15, health: 0.05, sos: 0.05 },
    TE: { opp: 0.32, eff: 0.23, role: 0.20, team: 0.15, health: 0.05, sos: 0.05 },
    QB: { opp: 0.25, eff: 0.35, role: 0.15, team: 0.20, health: 0.03, sos: 0.02 }
  },
  dynasty: {
    RB: { proj3: 0.40, age: 0.20, role: 0.15, eff: 0.10, team: 0.10, ped: 0.05 },
    WR: { proj3: 0.40, age: 0.20, role: 0.15, eff: 0.15, team: 0.07, ped: 0.03 },
    TE: { proj3: 0.40, age: 0.20, role: 0.15, eff: 0.10, team: 0.10, ped: 0.05 },
    QB: { proj3: 0.40, age: 0.20, role: 0.15, eff: 0.15, team: 0.10, ped: 0.00 }
  }
};

Handoff for Navbar grouping (quick win, same sprint)

Group Leaders / Snap Count / SOS under ‚ÄúResearch & Analysis‚Äù (you asked earlier). Tiber already has the spec; keep it in this PR if convenient.

Definition of Done (v1)

Data tables live & populated (2024 coverage).

/api/ratings returns ranked lists for redraft & dynasty with debug + VOR + tiers.

Recompute script/job exists.

QA checklist passes (Claude).

Handoffs archived in repo docs/.