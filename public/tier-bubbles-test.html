<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tier Bubbles API Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .tier-bubble { 
            background: #f0f8ff; 
            border: 2px solid #0079f2; 
            border-radius: 12px; 
            padding: 16px; 
            margin: 12px 0; 
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .player-card { 
            background: white; 
            border: 1px solid #ddd; 
            border-radius: 6px; 
            padding: 8px 12px; 
            font-size: 14px;
            white-space: nowrap;
        }
        select { padding: 8px; margin: 10px 5px; }
        .debug-info { background: #f5f5f5; padding: 10px; margin: 10px 0; border-radius: 4px; }
        pre { font-size: 12px; }
    </style>
</head>
<body>
    <h1>Tier Bubbles API Test</h1>
    
    <select onchange="debugTierBubbles(this.value)">
        <option value="dynasty">Dynasty</option>
        <option value="redraft">Redraft</option>
        <option value="dynasty_contender">Dynasty Contender</option>
        <option value="dynasty_rebuilder">Dynasty Rebuilder</option>
    </select>

    <div id="debug-info" class="debug-info"></div>
    <div id="tier-bubbles-list"></div>

    <script>
        // Debug: Log Tier Bubble API Response by Format
        async function debugTierBubbles(format) {
            const debugDiv = document.getElementById('debug-info');
            const container = document.getElementById('tier-bubbles-list');
            
            try {
                const response = await fetch('/api/tier-bubbles');
                const data = await response.json();

                debugDiv.innerHTML = `
                    <h3>üõ†Ô∏è Full API Response Structure:</h3>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;

                const bubbles = data[format];
                console.log(\`üîé Tier Bubble Data for Format [\${format}]:\`, bubbles);

                container.innerHTML = '';

                if (!bubbles || bubbles.length === 0) {
                    container.innerHTML = \`<p>‚ö†Ô∏è No tier bubble data found for format: \${format}</p>\`;
                    console.warn(\`‚ö†Ô∏è No tier bubble data found for format: \${format}\`);
                } else {
                    console.info(\`‚úÖ Found \${bubbles.length} tier bubbles for \${format}\`);
                    
                    bubbles.forEach((bubble, index) => {
                        const bubbleContainer = document.createElement('div');
                        bubbleContainer.className = 'tier-bubble';
                        
                        const tierHeader = document.createElement('strong');
                        tierHeader.textContent = \`Tier \${index + 1} (\${bubble.players.length} players)\`;
                        tierHeader.style.width = '100%';
                        tierHeader.style.marginBottom = '8px';
                        bubbleContainer.appendChild(tierHeader);

                        bubble.players.forEach(player => {
                            const playerCard = document.createElement('div');
                            playerCard.className = 'player-card';
                            playerCard.innerHTML = \`
                                <strong>\${player.player_name}</strong><br>
                                <small>\${player.position} ‚Äì \${player.team}</small>
                            \`;
                            bubbleContainer.appendChild(playerCard);
                        });

                        container.appendChild(bubbleContainer);
                    });
                }
            } catch (error) {
                debugDiv.innerHTML = \`<h3>‚ùå Error:</h3><pre>\${error.message}</pre>\`;
                container.innerHTML = \`<p>‚ùå Error loading tier bubbles: \${error.message}</p>\`;
                console.error('Error fetching tier bubbles:', error);
            }
        }

        // Load default format on page load
        window.onload = function() {
            debugTierBubbles('dynasty');
        };
    </script>
</body>
</html>